<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FONIX MATRIX v510</title>
    <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=Syncopate:wght@700&display=swap" rel="stylesheet">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";

        // Firebase Ayarlarƒ±
        const firebaseConfig = {
            apiKey: "AIzaSyCfQGeQUVom6cX8aDyfXdGNly0L1Rlj87I",
            authDomain: "fonixapp.firebaseapp.com",
            projectId: "fonixapp",
            storageBucket: "fonixapp.firebasestorage.app",
            messagingSenderId: "980255542194",
            appId: "1:980255542194:web:883a3f7a8fc05fee6332ab"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const tg = window.Telegram.WebApp;

        // Kullanƒ±cƒ± Kimliƒüi
        const user = tg.initDataUnsafe?.user;
        const myID = user?.id ? user.id.toString() : "8392479231"; 

        // Kart Tanƒ±mlarƒ± (G√∂rsele Uygun)
        const CARDS_DATA = {
            common: [
                { id: 'com_1', name: 'Hedgehog Miner', img: 'https://i.ibb.co/L6vjGND/hedgehog.png', clr: '#32FF7E' },
                { id: 'com_2', name: 'USB Pickaxe #2', img: 'https://i.ibb.co/m0fXf8z/pickaxe.png', clr: '#32FF7E' },
                { id: 'com_3', name: 'COMMON #3', img: 'https://i.ibb.co/L6vjGND/hedgehog.png', clr: '#32FF7E' }
            ],
            epic: [
                { id: 'epic_1', name: 'Quantum Drill', img: 'https://i.ibb.co/3WqPzK6/drill.png', clr: '#A335EE' },
                { id: 'epic_2', name: 'EPIC #2', img: 'https://i.ibb.co/3WqPzK6/drill.png', clr: '#A335EE' },
                { id: 'epic_3', name: 'EPIC #3', img: 'https://i.ibb.co/3WqPzK6/drill.png', clr: '#A335EE' }
            ],
            legendary: [
                { id: 'leg_1', name: 'LEGENDARY #1', img: 'https://i.ibb.co/0f3fL4X/titan.png', clr: '#FF9F43' },
                { id: 'leg_2', name: 'LEGENDARY #2', img: 'https://i.ibb.co/0f3fL4X/titan.png', clr: '#FF9F43' },
                { id: 'leg_3', name: 'LEGENDARY #3', img: 'https://i.ibb.co/0f3fL4X/titan.png', clr: '#FF9F43' }
            ],
            og: [
                { id: 'og_1', name: 'OG SERIE #1', img: 'https://i.ibb.co/L6vjGND/hedgehog.png', clr: '#48DBFB' },
                { id: 'og_2', name: 'OG SERIE #2', img: 'https://i.ibb.co/L6vjGND/hedgehog.png', clr: '#48DBFB' },
                { id: 'og_3', name: 'OG SERIE #3', img: 'https://i.ibb.co/L6vjGND/hedgehog.png', clr: '#48DBFB' }
            ]
        };

        let stats = { usdt: 0, ton: 0, inventory: [] };

        async function init() {
            const snap = await getDoc(doc(db, "users", myID));
            if (snap.exists()) stats = snap.data();
            else {
                stats = { usdt: 0, ton: 0, adsToday: 0, inventory: [], lastAdDate: new Date().toDateString() };
                await setDoc(doc(db, "users", myID), stats);
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById('usdt-v').innerText = stats.usdt.toFixed(5);
            document.getElementById('ton-v').innerText = stats.ton.toFixed(6);
            
            const matrix = document.getElementById('album-matrix');
            matrix.innerHTML = "";

            Object.entries(CARDS_DATA).forEach(([tier, cards]) => {
                let row = document.createElement('div');
                row.className = 'tier-row';
                row.innerHTML = `<div class="tier-label">${tier.toUpperCase()}</div>`;
                
                let grid = document.createElement('div');
                grid.className = 'cards-grid';

                cards.forEach((card, idx) => {
                    const owned = stats.inventory?.includes(card.id);
                    grid.innerHTML += `
                        <div class="card-box ${owned ? 'owned' : 'locked'}" style="--c: ${card.clr}">
                            <div class="card-num">#${idx + 1}</div>
                            <div class="card-art">
                                <img src="${card.img}">
                                ${!owned ? '<span class="lock">üîí</span>' : ''}
                            </div>
                            <div class="card-info">${owned ? card.name : tier.toUpperCase() + ' #' + (idx + 1)}</div>
                        </div>
                    `;
                });
                row.appendChild(grid);
                matrix.appendChild(row);
            });
        }

        window.switchTab = (id, btn) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.n-btn').forEach(b => b.classList.remove('on'));
            btn.classList.add('on');
        };

        window.onload = init;
    </script>

    <style>
        :root { --bg: #121417; --surface: #1B1E23; --accent: #00FFCC; --border: #2D323A; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: 'Plus Jakarta Sans', sans-serif; overflow: hidden; }
        
        .app { height: 100vh; display: flex; flex-direction: column; }

        /* Header */
        .header { padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-family: 'Syncopate'; font-size: 14px; display: flex; align-items: center; gap: 8px; }
        .stats { display: flex; gap: 8px; }
        .stat-box { background: var(--surface); border: 1px solid var(--border); padding: 8px 12px; border-radius: 12px; min-width: 90px; }
        .stat-box label { font-size: 7px; color: #888; font-weight: 800; display: block; margin-bottom: 2px; }
        .stat-box span { font-family: 'Syncopate'; font-size: 11px; color: var(--accent); }

        /* Tabs */
        .content { flex: 1; overflow-y: auto; padding: 15px; }
        .tab { display: none; }
        .active { display: block; animation: fade 0.3s; }

        /* Album Grid */
        .album-title { font-family: 'Syncopate'; font-size: 14px; text-align: center; margin-bottom: 25px; 
            border-bottom: 2px solid var(--accent); width: fit-content; margin: 0 auto 20px; padding-bottom: 5px; }
        .tier-row { margin-bottom: 25px; }
        .tier-label { font-size: 10px; opacity: 0.5; font-family: 'Syncopate'; margin-bottom: 12px; letter-spacing: 1px; }
        .cards-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }

        .card-box { aspect-ratio: 1/1.3; border-radius: 12px; border: 1px solid var(--border); background: #15181D; 
            display: flex; flex-direction: column; align-items: center; justify-content: space-between; padding: 10px 5px; position: relative; }
        .card-num { position: absolute; top: 10px; right: 10px; font-size: 8px; font-weight: 800; color: var(--c); }
        .card-art { width: 70%; position: relative; }
        .card-art img { width: 100%; height: auto; object-fit: contain; }
        .card-info { font-size: 8px; font-weight: 800; text-align: center; color: var(--c); }

        .owned { border-color: var(--c); box-shadow: inset 0 0 15px rgba(255,255,255,0.02), 0 0 10px var(--c); }
        .locked { filter: grayscale(1); opacity: 0.3; }
        .lock { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); font-size: 20px; }

        /* Bottom Nav */
        .nav { height: 75px; background: var(--surface); border-top: 1px solid var(--border); display: flex; justify-content: space-around; align-items: center; }
        .n-btn { background: none; border: none; color: #fff; opacity: 0.4; font-family: 'Syncopate'; font-size: 9px; display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .on { opacity: 1; color: var(--accent); }
        .icon { font-size: 20px; }

        @keyframes fade { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="app">
    <div class="header">
        <div class="logo">üöÄ FONIX <span style="font-size: 8px; opacity: 0.5;">MATRIX v510</span></div>
        <div class="stats">
            <div class="stat-box"><label>USDT ASSETS</label><span id="usdt-v">0.00000</span></div>
            <div class="stat-box"><label>TON NETWORK</label><span id="ton-v" style="color: #00ccff">0.000000</span></div>
        </div>
    </div>

    <div class="content">
        <div id="home" class="tab">
            <div style="text-align: center; margin-top: 50px;">
                <div style="font-size: 60px;">üéÅ</div>
                <h2 style="font-family: 'Syncopate'; color: var(--accent);">GIFT CHEST</h2>
                <button onclick="tg.showAlert('Yakƒ±nda!')" style="background: var(--accent); border:none; padding:15px 30px; border-radius:12px; font-family:'Syncopate';">SANDIƒûI A√á</button>
            </div>
        </div>

        <div id="album" class="tab active">
            <div class="album-title">ALBUM</div>
            <div id="album-matrix"></div>
        </div>

        <div id="cash" class="tab">
            <div class="album-title">CASH</div>
            <p style="text-align: center; opacity: 0.5;">√áekim talepleri inceleniyor...</p>
        </div>
    </div>

    <div class="nav">
        <button class="n-btn" onclick="switchTab('home', this)">
            <span class="icon">üéÅ</span><span>HOME</span>
        </button>
        <button class="n-btn on" onclick="switchTab('album', this)">
            <span class="icon">üöÄ</span><span>ALBUM</span>
        </button>
        <button class="n-btn" onclick="switchTab('cash', this)">
            <span class="icon">üí∞</span><span>CASH</span>
        </button>
    </div>
</div>

</body>
</html>
