<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEBULA USDT - V65</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&family=Montserrat:wght@900&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --bg-main: #4c3ba5; --bg-dark: #050505; --bg-card: #1e293b; 
            --accent: #00ff88; --yellow: #fbc02d; --red: #ff3131;
        }

        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Fredoka', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg-main); color: white; overflow: hidden; height: 100vh; }

        /* VIEWS */
        .view { display: none; height: 100vh; flex-direction: column; padding: 25px; overflow-y: auto; padding-bottom: 120px; }
        .view.active { display: flex; }

        /* HOME VIEW (CLASSIC PET) */
        #v-home { align-items: center; justify-content: center; text-align: center; background: radial-gradient(circle at 50% 30%, #5e48c2 0%, #1a1a2e 100%); }
        .hero-img { width: 180px; filter: drop-shadow(0 0 20px rgba(0,255,136,0.2)); margin-bottom: 15px; }
        .bal-display { font-family: 'Montserrat'; font-size: 3rem; color: var(--accent); margin-bottom: 25px; }

        /* MINING OVERLAY (V64 ENGINE) */
        #v-mining { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:var(--bg-dark); z-index:7000; flex-direction:column; align-items:center; justify-content:space-between; padding:50px 20px; }
        .fan-container { position:relative; width:260px; height:260px; display:flex; align-items:center; justify-content:center; }
        .fan-spin { width: 200px; height: 200px; border-radius: 50%; border: 4px solid #111; animation: rotate var(--spin-speed, 2s) linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* TASKS */
        .task-card { background: rgba(255,255,255,0.06); padding: 20px; border-radius: 20px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; }
        .reward-tag { color: var(--accent); font-weight: 700; font-size: 0.9rem; }

        /* WITHDRAW CARDS */
        .bank-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .bank-card { background: var(--bg-card); padding: 20px; border-radius: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.1); }
        .bank-card img { height: 25px; margin-bottom: 10px; filter: brightness(2); }

        /* DRAWERS */
        .drawer { position: fixed; bottom: 0; left: 0; width: 100%; background: #111; border-top: 4px solid var(--accent); border-radius: 30px 30px 0 0; padding: 30px; z-index: 8000; transform: translateY(100%); transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .drawer.open { transform: translateY(0); }
        .input-box { width: 100%; background: #1a1a1a; border: 1px solid #333; padding: 15px; border-radius: 12px; color: white; margin-bottom: 15px; font-size: 1rem; }

        /* NAV */
        nav { position: fixed; bottom: 0; width: 100%; height: 95px; background: rgba(10,10,10,0.95); backdrop-filter: blur(15px); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid rgba(255,255,255,0.05); z-index: 1000; }
        .nav-item { text-align: center; opacity: 0.4; font-size: 0.7rem; color: white; transition: 0.3s; }
        .nav-item.active { opacity: 1; color: var(--accent); }
        .nav-item i { font-size: 1.6rem; display: block; margin-bottom: 5px; }

        /* BUTTONS */
        .btn-main { width: 100%; padding: 18px; border: none; border-radius: 50px; font-size: 1.2rem; font-weight: 900; cursor: pointer; transition: 0.2s; }
        .btn-green { background: var(--accent); color: black; box-shadow: 0 5px 0 #009e54; }
        .btn-red { background: var(--red); color: white; box-shadow: 0 5px 0 #b2102f; }
        .btn-main:active { transform: translateY(3px); box-shadow: none; }
    </style>
</head>
<body>

    <header style="position:fixed; top:15px; width:100%; display:flex; justify-content:space-between; padding:0 25px; z-index:100;">
        <div style="background:rgba(0,0,0,0.5); padding:6px 15px; border-radius:20px; font-size:0.7rem; border:1px solid var(--accent);">ID: 8392479231</div>
        <div style="background:#26a17b; padding:6px 15px; border-radius:20px; font-size:0.7rem; font-weight:700;">USDT TRC20</div>
    </header>

    <div id="v-home" class="view active">
        <img src="yourfantastic.jpg" class="hero-img" onerror="this.src='https://via.placeholder.com/180'">
        <h2 style="font-size:1.8rem; letter-spacing:1px;">FANTASTIC PET</h2>
        <div class="bal-display"><span id="total-bal">0.00</span> <small style="font-size:1rem; opacity:0.5;">USDT</small></div>
        <button class="btn-main btn-green" style="width:85%;" onclick="startMining()">MINING'I BA≈ûLAT</button>
    </div>

    <div id="v-tasks" class="view">
        <h2 style="margin-bottom:20px;">G√ñREVLER</h2>
        <div class="task-card">
            <div><h4>√ñrnek G√∂rev #1</h4><p style="font-size:0.75rem; opacity:0.6;">Telegram Kanalƒ±na Katƒ±l</p></div>
            <div class="reward-tag">0.50$</div>
            <button class="btn-main" style="width:auto; padding:8px 15px; font-size:0.8rem; background:var(--accent); color:black;" onclick="openTask('√ñrnek G√∂rev #1', 0.50, 'Resmi duyuru kanalƒ±mƒ±za katƒ±lƒ±n ve ayrƒ±lmayƒ±n.')">YAP</button>
        </div>
        <div class="task-card">
            <div><h4>√ñrnek G√∂rev #2</h4><p style="font-size:0.75rem; opacity:0.6;">X Takip (Twitter)</p></div>
            <div class="reward-tag">0.25$</div>
            <button class="btn-main" style="width:auto; padding:8px 15px; font-size:0.8rem; background:var(--accent); color:black;" onclick="openTask('√ñrnek G√∂rev #2', 0.25, 'X hesabƒ±mƒ±zƒ± takip ederek g√ºncel kalƒ±n.')">YAP</button>
        </div>
    </div>

    <div id="v-wallet" class="view">
        <h2 style="margin-bottom:10px;">PARA √áEK</h2>
        <p style="font-size:0.8rem; opacity:0.6; margin-bottom:25px;">Minimum √áekim Tutarƒ±: <b>5.00 USDT</b></p>
        
        <div class="bank-grid">
            <div class="bank-card" onclick="openWithdraw('Binance')">
                <img src="https://cryptologos.cc/logos/binance-coin-bnb-logo.png">
                <span>Binance</span>
            </div>
            <div class="bank-card" onclick="openWithdraw('Bybit')">
                <img src="https://cryptologos.cc/logos/bybit-bit-logo.png">
                <span>Bybit</span>
            </div>
            <div class="bank-card" onclick="openWithdraw('OKX')">
                <img src="https://cryptologos.cc/logos/okb-okb-logo.png">
                <span>OKX</span>
            </div>
            <div class="bank-card" onclick="openWithdraw('Gate.io')">
                <img src="https://cryptologos.cc/logos/gatechain-token-gt-logo.png">
                <span>Gate.io</span>
            </div>
        </div>
    </div>

    <div id="v-mining">
        <div style="width:100%; display:flex; justify-content:space-between; opacity:0.5; font-size:0.7rem;">
            <div>GH/s: <span id="m-ghs" style="color:var(--accent)">0.00</span></div>
            <div>TEMP: <span id="m-temp">34</span>¬∞C</div>
        </div>
        <div style="text-align:center;">
            <h1 style="font-family:'Montserrat'; letter-spacing:4px; color:var(--accent);">MINING</h1>
            <p id="m-cycle" style="font-size:0.6rem; opacity:0.5;">D√ñNG√ú: 0/30s</p>
        </div>
        <div class="fan-container">
            <svg style="position:absolute; width:100%; height:100%; transform:rotate(-90deg);">
                <circle cx="130" cy="130" r="120" stroke="rgba(255,255,255,0.05)" stroke-width="6" fill="transparent"/>
                <circle id="m-progress" cx="130" cy="130" r="120" stroke="var(--accent)" stroke-width="6" fill="transparent" stroke-dasharray="754" stroke-dashoffset="754" style="transition:0.5s;"/>
            </svg>
            <img src="pinix.jpg" id="m-fan" class="fan-spin" onerror="this.src='https://via.placeholder.com/200'">
        </div>
        <div style="text-align:center; background:rgba(255,255,255,0.03); padding:20px; border-radius:20px; width:100%;">
            <div style="font-size:0.7rem; opacity:0.4;">KAZANILAN USDT</div>
            <div id="m-earned" style="font-size:2.8rem; color:var(--accent); font-family:'Montserrat'">0.0000</div>
        </div>
        <button class="btn-main btn-red" onclick="stopMining()">DURDUR VE TOPLA</button>
    </div>

    <div id="task-drawer" class="drawer">
        <h3 id="td-title" style="color:var(--yellow)">G√ñREV</h3>
        <p id="td-desc" style="margin:15px 0; font-size:0.9rem; opacity:0.7;">Detaylar y√ºkleniyor...</p>
        <div style="background:#000; padding:15px; border-radius:15px; text-align:center; margin-bottom:20px;">
            √ñd√ºl: <span id="td-reward" style="color:var(--accent); font-weight:900;">0.00 USDT</span>
        </div>
        <button class="btn-main btn-green" onclick="completeTaskAction()">G√ñREVƒ∞ BA≈ûLAT</button>
        <button onclick="closeDrawers()" style="width:100%; background:none; border:none; color:white; margin-top:15px; opacity:0.4;">Vazge√ß</button>
    </div>

    <div id="withdraw-drawer" class="drawer">
        <h3 id="wd-title">USDT √áEKƒ∞M</h3>
        <p style="margin:10px 0 20px; font-size:0.8rem; opacity:0.5;">L√ºtfen <b>USDT TRC20</b> aƒüƒ±ndaki adresinizi girin.</p>
        <input type="text" id="wd-addr" class="input-box" placeholder="TRC20 C√ºzdan Adresi">
        <input type="number" id="wd-amount" class="input-box" placeholder="Miktar (Min: 5.00)">
        <button class="btn-main btn-green" onclick="processWithdraw()">√áEKƒ∞M TALEBƒ∞ G√ñNDER</button>
        <button onclick="closeDrawers()" style="width:100%; background:none; border:none; color:white; margin-top:15px; opacity:0.4;">ƒ∞ptal</button>
    </div>

    <nav>
        <div class="nav-item" onclick="showTab('v-tasks', this)"><i>üéÅ</i>Tasks</div>
        <div class="nav-item active" onclick="showTab('v-home', this)"><i>üêæ</i>Home</div>
        <div class="nav-item" onclick="showTab('v-wallet', this)"><i>üí≥</i>Wallet</div>
    </nav>

<script>
    const tg = window.Telegram.WebApp;
    const firebaseConfig = { apiKey: "AIzaSyApwj-8tB4qxqe8yJ9uP7XuKfEdT2lwYv4", authDomain: "fonix-b4de6.firebaseapp.com", projectId: "fonix-b4de6", storageBucket: "fonix-b4de6.firebasestorage.app", messagingSenderId: "20899545652", appId: "1:20899545652:web:f32ef599f0c8d3deaec061" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const uid = tg.initDataUnsafe?.user?.id ? String(tg.initDataUnsafe.user.id) : "dev_test";

    let uData = { pi: 0, lvl: 1 }; 
    let mInt = null, sec = 0, sessUsdt = 0;
    let activeTask = null;

    function init() {
        tg.expand();
        db.collection("users").doc(uid).onSnapshot(doc => {
            if(doc.exists) { 
                uData = doc.data(); 
                document.getElementById('total-bal').innerText = uData.pi.toFixed(2);
            } else { db.collection("users").doc(uid).set(uData); }
        });
    }

    function showTab(id, el) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        el.classList.add('active');
    }

    // --- MINING ---
    function startMining() {
        document.getElementById('v-mining').style.display = 'flex';
        sec = 0; sessUsdt = 0;
        mInt = setInterval(() => {
            sec++;
            let speed = (Math.random() * 4 + 3);
            document.getElementById('m-ghs').innerText = speed.toFixed(2);
            document.documentElement.style.setProperty('--spin-speed', (2 / (speed/3)) + 's');
            document.getElementById('m-temp').innerText = Math.floor(Math.random() * 4 + 36);

            let cycle = sec % 30;
            document.getElementById('m-cycle').innerText = `D√ñNG√ú: ${cycle}/30s`;
            let offset = 754 - (cycle * (754/30));
            document.getElementById('m-progress').style.strokeDashoffset = offset;

            sessUsdt += 0.0001;
            document.getElementById('m-earned').innerText = sessUsdt.toFixed(4);
            if(sec % 10 === 0) tg.HapticFeedback.impactOccurred('light');
        }, 1000);
    }

    function stopMining() {
        clearInterval(mInt);
        db.collection("users").doc(uid).update({ pi: firebase.firestore.FieldValue.increment(sessUsdt) });
        document.getElementById('v-mining').style.display = 'none';
        tg.showAlert(`${sessUsdt.toFixed(4)} USDT toplandƒ±!`);
        sessUsdt = 0;
    }

    // --- TASKS ---
    function openTask(name, reward, desc) {
        activeTask = { name, reward };
        document.getElementById('td-title').innerText = name;
        document.getElementById('td-reward').innerText = reward + " USDT";
        document.getElementById('td-desc').innerText = desc;
        document.getElementById('task-drawer').classList.add('open');
    }

    function completeTaskAction() {
        tg.showAlert("Y√∂nlendiriliyorsunuz...");
        setTimeout(() => {
            tg.showConfirm("G√∂revi tamamladƒ±nƒ±z mƒ±?", (ok) => {
                if(ok) {
                    db.collection("users").doc(uid).update({ pi: firebase.firestore.FieldValue.increment(activeTask.reward) });
                    closeDrawers();
                    tg.showAlert("Tebrikler! √ñd√ºl hesabƒ±nƒ±za eklendi.");
                }
            });
        }, 2000);
    }

    // --- WITHDRAW ---
    function openWithdraw(bank) {
        document.getElementById('wd-title').innerText = bank + " USDT √áekim";
        document.getElementById('withdraw-drawer').classList.add('open');
    }

    function processWithdraw() {
        const amount = parseFloat(document.getElementById('wd-amount').value);
        const addr = document.getElementById('wd-addr').value;

        if(amount < 5) return tg.showAlert("Hata: Minimum √ßekim 5 USDT'dir.");
        if(uData.pi < amount) return tg.showAlert("Yetersiz bakiye!");
        if(addr.length < 10) return tg.showAlert("L√ºtfen ge√ßerli bir TRC20 adresi girin.");

        tg.showAlert("√áekim talebi olu≈üturuldu! Admin (8392479231) tarafƒ±ndan kontrol edilecektir.");
        closeDrawers();
    }

    function closeDrawers() {
        document.querySelectorAll('.drawer').forEach(d => d.classList.remove('open'));
    }

    window.onload = init;
</script>
</body>
</html>
