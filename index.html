<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FONIX ADS v502</title>
    <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
    <script src="https://adexora.com/cdn/ads.js?id=1701"></script>
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Plus+Jakarta+Sans:wght@300;500;800&display=swap" rel="stylesheet">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, increment } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCfQGeQUVom6cX8aDyfXdGNly0L1Rlj87I",
            authDomain: "fonixapp.firebaseapp.com",
            projectId: "fonixapp",
            storageBucket: "fonixapp.firebasestorage.app",
            messagingSenderId: "980255542194",
            appId: "1:980255542194:web:883a3f7a8fc05fee6332ab"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const tg = window.Telegram.WebApp;
        tg.expand();

        const user = tg.initDataUnsafe?.user;
        const myID = user?.id ? user.id.toString() : "8392479231"; 
        
        const DAILY_LIMIT = 50;
        let stats = { usdt: 0, adsToday: 0, lastAdDate: "" };

        async function init() {
            const userRef = doc(db, "users", myID);
            const snap = await getDoc(userRef);
            const today = new Date().toDateString();

            if (snap.exists()) {
                stats = snap.data();
                // G√ºn deƒüi≈ütiyse limiti sƒ±fƒ±rla
                if (stats.lastAdDate !== today) {
                    stats.adsToday = 0;
                    stats.lastAdDate = today;
                    await updateDoc(userRef, { adsToday: 0, lastAdDate: today });
                }
            } else {
                stats = { usdt: 0, adsToday: 0, lastAdDate: today, username: user?.username || "User", invitedBy: tg.initDataUnsafe?.start_param || "" };
                await setDoc(userRef, stats);
                if(stats.invitedBy) await updateDoc(doc(db, "users", stats.invitedBy), { usdt: increment(0.10) });
            }
            updateUI();
        }

        function updateUI() {
            document.getElementById('balance').innerText = stats.usdt.toFixed(4);
            document.getElementById('ad-count').innerText = stats.adsToday;
            document.getElementById('ad-limit').innerText = DAILY_LIMIT;
            
            const progress = (stats.adsToday / DAILY_LIMIT) * 100;
            document.getElementById('limit-bar').style.width = progress + "%";
            document.getElementById('ref-link').innerText = `https://t.me/FonixMiningBot?start=${myID}`;

            const btn = document.getElementById('main-ad-btn');
            if(stats.adsToday >= DAILY_LIMIT) {
                btn.innerText = "LIMIT REACHED";
                btn.style.opacity = "0.5";
                btn.onclick = null;
            }
        }

        window.watchAd = () => {
            if(stats.adsToday >= DAILY_LIMIT) return tg.showAlert("G√ºnl√ºk izleme limitine ula≈ütƒ±nƒ±z!");

            tg.HapticFeedback.impactOccurred('medium');
            window.showAdexora()
                .then(async () => {
                    const reward = 0.05; // Her reklam $0.05 kazandƒ±rƒ±r
                    stats.usdt += reward;
                    stats.adsToday += 1;
                    
                    const userRef = doc(db, "users", myID);
                    await updateDoc(userRef, { 
                        usdt: increment(reward), 
                        adsToday: increment(1) 
                    });
                    
                    updateUI();
                    tg.showAlert(`Tebrikler! $${reward} hesabƒ±nƒ±za eklendi.`);
                })
                .catch(() => {
                    tg.showAlert("Reklam ≈üu an hazƒ±r deƒüil. L√ºtfen 5 saniye sonra tekrar deneyin.");
                });
        };

        window.switchTab = (id, btn) => {
            document.querySelectorAll('.tab-page').forEach(p => p.classList.remove('on'));
            document.getElementById(id).classList.add('on');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('on-nav'));
            btn.classList.add('on-nav');
            tg.HapticFeedback.selectionChanged();
        };

        window.onload = init;
    </script>

    <style>
        :root { --main: #00ffcc; --dark: #07070a; --glass: rgba(255,255,255,0.03); }
        body { margin: 0; background: var(--dark); color: #fff; font-family: 'Plus Jakarta Sans', sans-serif; overflow: hidden; }
        .app-container { height: 100vh; display: flex; flex-direction: column; padding: 25px; box-sizing: border-box; }
        .tab-page { display: none; flex: 1; animation: slideUp 0.3s ease; }
        .on { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* Card Designs */
        .premium-card { background: linear-gradient(145deg, rgba(255,255,255,0.05), rgba(255,255,255,0.01)); border: 1px solid rgba(255,255,255,0.08); border-radius: 30px; padding: 30px; text-align: center; margin-bottom: 20px; }
        .balance-text { font-family: 'Syncopate'; font-size: 36px; font-weight: 700; color: var(--main); margin: 10px 0; }

        /* Action Button */
        .watch-btn { background: #fff; color: #000; border: none; width: 100%; height: 180px; border-radius: 40px; font-family: 'Syncopate'; font-weight: 700; font-size: 16px; letter-spacing: 2px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 15px 40px rgba(0,255,204,0.1); transition: 0.3s; }
        .watch-btn:active { transform: scale(0.95); background: var(--main); }
        .watch-btn span { font-size: 40px; margin-bottom: 10px; }

        /* Limit Bar */
        .limit-box { background: var(--glass); border: 1px solid rgba(255,255,255,0.05); border-radius: 20px; padding: 20px; margin-top: 20px; }
        .bar-wrap { width: 100%; height: 6px; background: rgba(255,255,255,0.05); border-radius: 10px; margin: 10px 0; overflow: hidden; }
        #limit-bar { width: 0%; height: 100%; background: var(--main); transition: 0.5s; }

        /* Nav */
        .nav-bar { position: fixed; bottom: 30px; left: 25px; right: 25px; background: rgba(15,15,20,0.9); backdrop-filter: blur(20px); border-radius: 25px; height: 75px; display: flex; justify-content: space-around; align-items: center; border: 1px solid rgba(255,255,255,0.05); }
        .nav-btn { background: none; border: none; color: #fff; opacity: 0.3; font-size: 9px; font-family: 'Syncopate'; }
        .on-nav { opacity: 1; color: var(--main); }
    </style>
</head>
<body>

<div class="app-container">
    <div id="home" class="tab-page on">
        <div style="display:flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
            <b style="font-family: 'Syncopate'; font-size: 11px; letter-spacing: 1px;">FONIX ADS</b>
            <div style="font-size: 10px; color: var(--main);">v502 PRO</div>
        </div>

        <div class="premium-card">
            <small style="opacity: 0.4; letter-spacing: 2px;">TOTAL EARNINGS</small>
            <div class="balance-text">$<span id="balance">0.0000</span></div>
        </div>

        <button id="main-ad-btn" class="watch-btn" onclick="watchAd()">
            <span>üé¨</span>
            WATCH AD
            <small style="font-size: 9px; opacity: 0.5; margin-top: 8px;">EARN $0.05 PER VIEW</small>
        </button>

        <div class="limit-box">
            <div style="display:flex; justify-content: space-between; font-size: 10px; font-family: 'Syncopate';">
                <span>DAILY LIMIT</span>
                <span><span id="ad-count">0</span> / <span id="ad-limit">50</span></span>
            </div>
            <div class="bar-wrap">
                <div id="limit-bar"></div>
            </div>
            <center><small style="font-size: 10px; opacity: 0.3;">Limits reset every 24 hours</small></center>
        </div>
    </div>

    <div id="ref" class="tab-page">
        <h2 style="font-family: 'Syncopate'; font-size: 18px;">NETWORK</h2>
        <div class="premium-card">
            <small style="opacity:0.4;">INVITE LINK</small>
            <div id="ref-link" style="font-size: 10px; background: #000; padding: 20px; border-radius: 15px; margin: 15px 0; word-break: break-all;">...</div>
            <button class="watch-btn" style="height: 60px; font-size: 12px;" onclick="navigator.clipboard.writeText(document.getElementById('ref-link').innerText); tg.showAlert('Kopyalandƒ±!')">COPY LINK</button>
        </div>
        <div class="premium-card" style="background: rgba(0, 255, 204, 0.05);">
            <small>REFERRAL BONUS</small>
            <div style="font-size: 20px; font-weight: 800; color: var(--main);">$0.10 USDT</div>
        </div>
    </div>

    <div id="wallet" class="tab-page">
        <h2 style="font-family: 'Syncopate'; font-size: 18px;">WALLET</h2>
        <div class="premium-card" style="text-align: left;">
            <label style="opacity: 0.4; font-size: 10px;">WITHDRAWAL AMOUNT</label>
            <input type="number" placeholder="Min 10.00" style="width:100%; background:none; border:none; border-bottom: 1px solid #333; color:#fff; font-size: 20px; padding: 15px 0; outline:none; font-family: 'Syncopate';">
            <br><br>
            <label style="opacity: 0.4; font-size: 10px;">USDT ADDRESS (TON)</label>
            <input type="text" placeholder="UQ..." style="width:100%; background:none; border:none; border-bottom: 1px solid #333; color:#fff; font-size: 14px; padding: 15px 0; outline:none;">
            <button class="watch-btn" style="height: 60px; margin-top: 30px; font-size: 12px; background: var(--main);">WITHDRAW FUNDS</button>
        </div>
    </div>

    <div class="nav-bar">
        <button class="nav-btn on-nav" onclick="switchTab('home', this)">üé¨<br>ADS</button>
        <button class="nav-btn" onclick="switchTab('ref', this)">üõ∞Ô∏è<br>NET</button>
        <button class="nav-btn" onclick="switchTab('wallet', this)">üí∞<br>CASH</button>
    </div>
</div>

</body>
</html>
